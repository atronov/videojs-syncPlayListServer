<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>videojs queue</title>
    <link href="http://vjs.zencdn.net/4.12/video-js.css" rel="stylesheet">
    <script src="http://vjs.zencdn.net/4.12/video.js"></script>
    <script src="/lib/videojs-playlists.js"></script>
    <script src="/lib/videojs-syncPlayList.js"></script>
    <style>
        .image_container {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            text-align: center;
        }

        .video_image {
            max-height: 100%;
            max-width: 100%;
            height: auto;
        }
    </style>
</head>
<body>
    <div class="player1">
        <video class="video-js vjs-default-skin" controls
            preload="auto"
            data-setup='{}' >
        </video>
        <button class="next">next</button>
        <button class="prev">prev</button>
    </div>
    <div class="player2">
        <video class="video-js vjs-default-skin" controls
            preload="auto"
            data-setup='{}' >
        </video>
        <button class="next">next</button>
        <button class="prev">prev</button>
    </div>
    <script>
        var options2 = {
            element: document.querySelector(".player2 .video-js"),
            playListId: 1,
            getVideoSource: getVideoSource,
            prevBtn: document.querySelector(".player2 .prev").addEventListener("click", player.prev.bind(player)),
            nextBtn: document.querySelector(".player2 .next").addEventListener("click", player.next.bind(player))
        };

        var options1 = {
            element: document.querySelector(".player1 .video-js"),
            playListId: 0,
            getVideoSource: getVideoSource,
            prevBtn: document.querySelector(".player1 .prev").addEventListener("click", player.prev.bind(player)),
            nextBtn: document.querySelector(".player1 .next").addEventListener("click", player.next.bind(player))
        };

        play(options1);
        play(options2);
  
        function play(options) {
            var player = videojs(options.element);
            player.syncPlayList(options).then(function(player) {
                
            });
        };
    
        function getVideoSource(node, cb) {      
            var player = this;
            var emptyVideoPaths = [ { src: "/video/empty.webm" } ];
            var src = node.src;
            var poster = node.poster;
            if (node.isSlide) {
                src = emptyVideoPaths;
                showImage(player, poster);
            } else {
                hideImage(player);
            }
            cb(src, poster);
        }

        function showImage(player, imgPath) {
            var container = player.el().querySelector(".image_container");
            if (!container) {
                container = document.createElement("div");
                container.className = "image_container";
                var img = document.createElement("img");
                img.className = "video_image";
                container.appendChild(img);
                player.el().appendChild(container);
            }
            container.style.display = "block";
            img.src = imgPath;
        }

        function hideImage(player) {
            var container = player.el().querySelector(".image_container");
            if (container) {
                container.style.display = "none";
            }
        }
    </script>
</body>
</html>